\RequirePackage{appendix}
\RequirePackage{caption}
\RequirePackage{emptypage}
\RequirePackage{enumitem}
\RequirePackage{fancyhdr}
\RequirePackage{geometry}
\RequirePackage{graphicx}
\RequirePackage[hidelinks]{hyperref}
\RequirePackage[numbers,sort&compress,sectionbib]{natbib}
\RequirePackage{setspace}
\RequirePackage{titlesec}
\RequirePackage{tocloft}
\RequirePackage{xepersian}
\RequirePackage[perpage, bottom]{footmisc}

%% تنظیم فاصله ی حاشیه صفحات
\geometry{paperheight=235mm, paperwidth=165mm, margin=20mm, right=25mm, marginparsep=0pt, asymmetric, includeheadfoot}

%% تنضیمات مربوط به فونت
\settextfont[Scale=1.2, Path=fonts/, BoldFont=B Nazanin Bold]{B Nazanin}
\setlatintextfont[Scale=1, Path=fonts/, BoldFont=Times New Roman Bold]{Times New Roman}

%% تنظیم پاراگراف بندی ها
\doublespacing

%% صفحه خالی
\newcommand{\blankpage}{
    \null
    \thispagestyle{empty}
    \newpage}

%% صفحه بسم الله
\newcommand{\bismillah}{
    \newpage
    \thispagestyle{empty}
    \vspace*{\fill}
    \begin{center}
        \includegraphics[width=0.8\textwidth]{images/bismillah.jpg}
    \end{center}
    \vspace*{\fill}}

%% سایز عنوان فهرست ها
\setlength{\cftbeforechapskip}{\baselineskip}
\renewcommand{\cfttoctitlefont}{\hfil\bfseries}
\renewcommand{\cftaftertoctitle}{\vspace{\baselineskip}}
\setlength{\cftaftertoctitleskip}{0pt}
\setlength{\cftbeforetoctitleskip}{-1.55em}
\addtocontents{toc}{\textbf{عنوان}\hfill\textbf{صفحه}\par}

\renewcommand{\cftlottitlefont}{\hfil\bfseries}
\renewcommand{\cftafterlottitle}{\vspace{\baselineskip}}
\setlength{\cftafterlottitleskip}{0pt}
\setlength{\cftbeforelottitleskip}{-1.55em}
\addtocontents{lot}{\textbf{عنوان}\hfill\textbf{صفحه}\par\vspace{\baselineskip}}

\renewcommand{\cftloftitlefont}{\hfil\bfseries}
\renewcommand{\cftafterloftitle}{\vspace{\baselineskip}}
\setlength{\cftafterloftitleskip}{0pt}
\setlength{\cftbeforeloftitleskip}{-1.55em}
\addtocontents{lof}{\textbf{عنوان}\hfill\textbf{صفحه}\par\vspace{\baselineskip}}

%% دستورات اضافه کردن کلمه فصل به ابتدای شماره فصل در فهرست
\let\orig@chapter\@chapter
\def\@chapter[#1]#2{
    \if@mainmatter
    \refstepcounter{chapter}
    \addcontentsline{toc}{chapter}{\chaptername~\tartibi{chapter}: #1}
    \else
    \addcontentsline{toc}{chapter}{#1}
    \fi
    \chaptermark{#1}
    \if@twocolumn
    \@topnewpage[\@makechapterhead{#2}]
    \else
    \@makechapterhead{#2}
    \@afterheading
    \fi}

%% استفاده از خط فاصله به جای نقطه در شماره گذاری سکشن ها
\SepMark{-}
\renewcommand{\cftsecaftersnum}{\@SepMark}
\renewcommand{\cftsubsecaftersnum}{\@SepMark}
\renewcommand{\cftsubsubsecaftersnum}{\@SepMark}

%% افزودن کلمه شکل به اول موارد موجود در لیست تصاویر و جداول
\setlength{\cfttabindent}{0pt}
\renewcommand{\cfttabpresnum}{جدول }
\settowidth{\cfttabnumwidth }{جدول 20\quad }
\renewcommand{\cfttabaftersnum}{\@SepMark}

\setlength{\cftfigindent}{0pt}
\renewcommand{\cftfigpresnum}{شکل }
\settowidth{\cftfignumwidth}{شکل 20\quad }
\renewcommand{\cftfigaftersnum}{\@SepMark}

%% نمایش خط فاصله در کپشن ها و لیست ها
\setlist{label=\arabic*-, nosep, left=0pt}
\DeclareCaptionLabelSeparator{dash}{- }
\captionsetup{font=small,labelsep=dash}

%% لیست نشانه های اختصاری
\newcommand\gloss[2]{{#1}~\dotfill~{#2}\\}

%% تنظیمات نقطه چین
\renewcommand{\dotfill}{\leavevmode\cleaders\hbox to 2pt{\hss.\hss}\hfill\kern0pt}
\renewcommand{\cftdotsep}{\cftdot}
\renewcommand{\cftchapdotsep}{\cftdot}

%% وسط چین شماره گذاری فصل و نحوه نمایش آن
\titleformat{\chapter}[display]{\Large\bfseries\centering}{\thispagestyle{empty}\chaptername~\tartibi{chapter}}{10pt}{\Large}
\titlespacing*{\chapter}{0pt}{60pt}{40pt}

%% تنظیم فونت سکشن ها
\titleformat{\section}{\normalsize\bfseries}{\thesection\@SepMark~}{0pt}{}
\titleformat{\subsection}{\normalsize\bfseries}{\thesubsection\@SepMark~}{0pt}{}

%% تنظیمات هدر و فوتر
\fancyhf{}
\fancyfoot[C]{\thepage}
\fancyhead[ER]{\leftmark}
\fancyhead[EL]{{\persiantype} \persiandegree}
\fancyhead[OR]{\persiantitle}
\setlength{\headheight}{14pt}
\addtolength{\topmargin}{-2pt}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername~\tartibi{chapter}: #1}{}}

%%  استایل منابع
\bibliographystyle{chicago-fa}

%% تنظیمات پیوست
\renewcommand{\appendixtocname}{پیوست‌ها}
\newcommand{\app}[1]{\protect\section[\hspace{1.5em}#1]{#1}}

%% کامندهای مربوط به اطلاعات پایان نامه
\newcommand{\name}[2]{\newcommand{\persianname}{#1}\newcommand{\latinname}{#2}}
\newcommand{\studentnumber}[1]{\newcommand{\persianstudentnumber}{#1}\newcommand{\latinstudentnumber}{#1}}

\newcommand{\university}[2]{\newcommand{\persianuniversity}{#1}\newcommand{\latinuniversity}{#2}}
\newcommand{\department}[2]{\newcommand{\persiandepartment}{#1}\newcommand{\latindepartment}{#2}}
\newcommand{\field}[2]{\newcommand{\persianfield}{#1}\newcommand{\latinfield}{#2}}
\newcommand{\degree}[2]{\newcommand{\persiandegree}{#1}\newcommand{\latindegree}{#2}}

\newcommand{\thesistitle}[2]{\newcommand{\persiantitle}{#1}\newcommand{\latintitle}{#2}}
\newcommand{\thesisdate}[2]{\newcommand{\persiandate}{#1}\newcommand{\latindate}{#2}}
\newcommand{\thesisgrade}[2]{\newcommand{\persiangrade}{#1}\newcommand{\latingrade}{#2}}
\newcommand{\thesistype}[2]{\newcommand{\persiantype}{#1}\newcommand{\latintype}{#2}}
\newcommand{\defensedate}[2]{\newcommand{\persiandefensedate}{#1}\newcommand{\latindefensedate}{#2}}

\newcommand{\supervisor}[2]{\newcommand{\persiansupervisor}{#1}\newcommand{\latinsupervisor}{#2}}
\newcommand{\supervisortitle}[2]{\newcommand{\persiansupervisortitle}{#1}\newcommand{\latinsupervisortitle}{#2}}
\newcommand{\supervisordepartment}[2]{\newcommand{\persiansupervisordepartment}{#1}\newcommand{\latinsupervisordepartment}{#2}}

\newcommand{\advisor}[2]{\newcommand{\persianadvisor}{#1}\newcommand{\latinadvisor}{#2}}
\newcommand{\advisortitle}[2]{\newcommand{\persianadvisortitle}{#1}\newcommand{\latinadvisortitle}{#2}}
\newcommand{\advisordepartment}[2]{\newcommand{\persianadvisordepartment}{#1}\newcommand{\latinadvisordepartment}{#2}}

\newcommand{\referee}[2]{\newcommand{\persianreferee}{#1}\newcommand{\latinreferee}{#2}}
\newcommand{\refereetitle}[2]{\newcommand{\persianrefereetitle}{#1}\newcommand{\latinrefereetitle}{#2}}
\newcommand{\refereedepartment}[2]{\newcommand{\persianrefereedepartment}{#1}\newcommand{\latinrefereedepartment}{#2}}

\newcommand{\externalreferee}[2]{\newcommand{\persianexternalreferee}{#1}\newcommand{\latinexternalreferee}{#2}}
\newcommand{\externalrefereetitle}[2]{\newcommand{\persianexternalrefereetitle}{#1}\newcommand{\latinexternalrefereetitle}{#2}}
\newcommand{\externalrefereedepartment}[2]{\newcommand{\persianexternalrefereedepartment}{#1}\newcommand{\latinexternalrefereedepartment}{#2}}
\newcommand{\externalrefereeuniversity}[2]{\newcommand{\persianexternalrefereeuniversity}{#1}\newcommand{\latinexternalrefereeuniversity}{#2}}
